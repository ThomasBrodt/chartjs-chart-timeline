!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("chart.js"),require("moment")):"function"==typeof define&&define.amd?define(["chart.js","moment"],e):e(t.Chart,t.moment)}(this,function(t,e){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e;var a=t.helpers;function i(t,i){if(a.isNullOrUndef(t))return null;var r=i.options.time,o=function(t,a){var i=a.parser,r=a.parser||a.format;return"function"==typeof i?i(t):"string"==typeof t&&"string"==typeof r?e(t,r):(t instanceof e||(t=e(t)),t.isValid()?t:"function"==typeof r?r(t):t)}(i.getRightValue(t),r);return o.isValid()?(r.round&&o.startOf(r.round),o.valueOf()):null}var r=Number.MIN_SAFE_INTEGER||-9007199254740991,o=Number.MAX_SAFE_INTEGER||9007199254740991,n=t.scaleService.getScaleConstructor("time").extend({determineDataLimits:function(){var t,a,n,l,s,d,c,h=this,u=h.chart,f=h.options.time,m=h.chart.options.elements,p=o,g=r,b=[],y={},x=[];for(t=0,n=(u.data.datasets||[]).length;t<n;++t)if(u.isDatasetVisible(t))for(s=u.data.datasets[t].data,x[t]=[],a=0,l=s.length;a<l;++a)(d=i(s[a][m.keyStart],h))>(c=i(s[a][m.keyEnd],h))&&([d,c]=[c,d]),p>d&&d&&(p=d),g<c&&c&&(g=c),x[t][a]=[d,c,s[a][m.keyValue]],Object.prototype.hasOwnProperty.call(y,d)&&(y[d]=!0,b.push(d)),Object.prototype.hasOwnProperty.call(y,c)&&(y[c]=!0,b.push(c));else x[t]=[];b.size&&b.sort(function(t,e){return t-e}),p=i(f.min,h)||p,g=i(f.max,h)||g,p=p===o?+e().startOf("day"):p,g=g===r?+e().endOf("day")+1:g,h.min=Math.min(p,g),h.max=Math.max(p+1,g),h._horizontal=h.isHorizontal(),h._table=[],h._timestamps={data:b,datasets:x,labels:[]}}});t.scaleService.registerScaleType("timeline",n,{position:"bottom",tooltips:{mode:"nearest"},adapters:{},time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",distribution:"linear",bounds:"data",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!0}}),t.controllers.timeline=t.controllers.bar.extend({getBarBounds:function(t){var e,a,i=t._view;return e=i.x,a=i.x+i.width,{left:e,top:i.y,right:a,bottom:i.y+i.height}},update:function(e){var i=this,r=i.getMeta(),o=i.chart.options;if(o.textPadding||o.minBarWidth||o.showText||o.colorFunction){var n=i.chart.options.elements;n.textPadding=o.textPadding||n.textPadding,n.minBarWidth=o.minBarWidth||n.minBarWidth,n.colorFunction=o.colorFunction||n.colorFunction,n.minBarWidth=o.minBarWidth||n.minBarWidth,!0!==t._tl_depwarn&&(console.log("Timeline Chart: Configuration deprecated. Please check document on Github."),t._tl_depwarn=!0)}a.each(r.data,function(t,a){i.updateElement(t,a,e)},i)},updateElement:function(e,i,r){var o=this,n=o.getMeta(),l=o.getDataset(),s=o.getScaleForId(n.xAxisID),d=o.getScaleForId(n.yAxisID);e._xScale=s,e._yScale=d,e._datasetIndex=o.index,e._index=i;var c=l.data[i],h=e.custom||{},u=o.index,f=o.chart.options.elements||t.defaults.timeline.elements,m=f.rectangle,p=f.textPadding,g=f.minBarWidth,b=c[f.keyValue],y=o.getRuler(i),x=s.getPixelForValue(c[f.keyStart]),v=s.getPixelForValue(c[f.keyEnd]),k=d.getPixelForValue(c,u,u),w=v-x,S=o.calculateBarHeight(y),_=a.color(f.colorFunction(b,c,l,i)),P=f.showText,B=f.font;B||(B='bold 12px "Helvetica Neue", Helvetica, Arial, sans-serif');var C=k-S/2;e._model={x:r?x-w:x,y:C,width:Math.max(w,g),height:S,base:x+w,backgroundColor:_.rgbaString(),borderSkipped:h.borderSkipped?h.borderSkipped:m.borderSkipped,borderColor:h.borderColor?h.borderColor:a.getValueAtIndexOrDefault(l.borderColor,i,m.borderColor),borderWidth:h.borderWidth?h.borderWidth:a.getValueAtIndexOrDefault(l.borderWidth,i,m.borderWidth),label:o.chart.data.labels[i],datasetLabel:l.label,text:b,textColor:_.luminosity()>.5?"#000000":"#ffffff"},e.draw=function(){var t=this._chart.ctx,e=this._view,a=t.globalAlpha,i=t.globalCompositeOperation;if(t.fillStyle=e.backgroundColor,t.lineWidth=e.borderWidth,t.globalCompositeOperation="destination-over",t.fillRect(e.x,e.y,e.width,e.height),t.globalAlpha=.5,t.globalCompositeOperation="source-over",t.fillRect(e.x,e.y,e.width,e.height),t.globalAlpha=a,t.globalCompositeOperation=i,P){t.beginPath();var r=t.measureText(e.text);r.width>0&&r.width+p+2<e.width&&(t.font=B,t.fillStyle=e.textColor,t.lineWidth=0,t.strokeStyle=e.textColor,t.textBaseline="middle",t.fillText(e.text,e.x+p,e.y+e.height/2)),t.fill()}},e.inXRange=function(t){var e=o.getBarBounds(this);return t>=e.left&&t<=e.right},e.tooltipPosition=function(){var t=this.getCenterPoint();return{x:t.x,y:t.y}},e.getCenterPoint=function(){var t=this._view;return{x:t.x+t.width/2,y:t.y+t.height/2}},e.inRange=function(t,e){var a=!1;if(this._view){var i=o.getBarBounds(this);a=t>=i.left&&t<=i.right&&e>=i.top&&e<=i.bottom}return a},e.pivot()},getBarCount:function(){var t=this,e=0;return a.each(t.chart.data.datasets,function(a,i){t.chart.getDatasetMeta(i).bar&&t.chart.isDatasetVisible(i)&&++e},t),e},draw:function(t){var e,a,i=t||1,r=this.getMeta().data;for(e=0,a=r.length;e<a;e++)r[e].transition(i).draw()},calculateBarHeight:function(t){var e=this.getScaleForId(this.getMeta().yAxisID);return e.options.barThickness?e.options.barThickness:e.options.stacked?t.categoryHeight:t.barHeight}}),t.defaults.timeline={elements:{colorFunction:function(){return a.color("black")},showText:!0,textPadding:4,minBarWidth:1,keyStart:0,keyEnd:1,keyValue:2},layout:{padding:{left:0,right:0,top:0,bottom:0}},legend:{display:!1},scales:{xAxes:[{type:"timeline",position:"bottom",distribution:"linear",categoryPercentage:.8,barPercentage:.9,gridLines:{display:!0,drawBorder:!0,drawTicks:!0},ticks:{maxRotation:0},unit:"day"}],yAxes:[{type:"category",position:"left",barThickness:20,categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{display:!0,offsetGridLines:!0,drawBorder:!0,drawTicks:!0}}]},tooltips:{callbacks:{title:function(t,e){this._chart.options.elements;return e.labels[t[0].datasetIndex]},label:function(t,a){var i=this._chart.options.elements,r=a.datasets[t.datasetIndex].data[t.index];return[r[i.keyValue],e(r[i.keyStart]).format("L LTS"),e(r[i.keyEnd]).format("L LTS")]}}}}});
