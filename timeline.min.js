!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("chart.js"),require("moment")):"function"==typeof define&&define.amd?define(["chart.js","moment"],e):e(t.Chart,t.moment)}(this,function(t,e){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e;var a=t.helpers;function r(t,r){if(a.isNullOrUndef(t))return null;var i=r.options.time,o=function(t,a){var r=a.parser,i=a.parser||a.format;return"function"==typeof r?r(t):"string"==typeof t&&"string"==typeof i?e(t,i):(t instanceof e||(t=e(t)),t.isValid()?t:"function"==typeof i?i(t):t)}(r.getRightValue(t),i);return o.isValid()?(i.round&&o.startOf(i.round),o.valueOf()):null}var i=Number.MIN_SAFE_INTEGER||-9007199254740991,o=Number.MAX_SAFE_INTEGER||9007199254740991,n=t.scaleService.getScaleConstructor("time").extend({determineDataLimits:function(){var t,a,n,l,d,s,h,c=this,u=c.chart,f=c.options.time,g=c.chart.options.elements,m=o,p=i,y=[],x={},b=[];for(t=0,n=(u.data.datasets||[]).length;t<n;++t)if(u.isDatasetVisible(t))for(d=u.data.datasets[t].data,b[t]=[],a=0,l=d.length;a<l;++a)(s=r(d[a][g.keyStart],c))>(h=r(d[a][g.keyEnd],c))&&([s,h]=[h,s]),m>s&&s&&(m=s),p<h&&h&&(p=h),b[t][a]=[s,h,d[a][g.keyValue]],Object.prototype.hasOwnProperty.call(x,s)&&(x[s]=!0,y.push(s)),Object.prototype.hasOwnProperty.call(x,h)&&(x[h]=!0,y.push(h));else b[t]=[];y.size&&y.sort(function(t,e){return t-e}),m=r(f.min,c)||m,p=r(f.max,c)||p,m=m===o?+e().startOf("day"):m,p=p===i?+e().endOf("day")+1:p,c.min=Math.min(m,p),c.max=Math.max(m+1,p),c._horizontal=c.isHorizontal(),c._table=[],c._timestamps={data:y,datasets:b,labels:[]}}});t.scaleService.registerScaleType("timeline",n,{position:"bottom",tooltips:{mode:"nearest"},adapters:{},time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",distribution:"linear",bounds:"data",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!0}}),t.controllers.timeline=t.controllers.bar.extend({_dataElementOptions:["backgroundColor","borderColor","borderSkipped","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","barThickness","maxBarThickness","minBarWidth","textPadding","showText","keyValue","keyStart","keyEnd"],getBarBounds:function(t){var e,a,r=t._view;return e=r.x,a=r.x+r.width,{left:e,top:r.y,right:a,bottom:r.y+r.height}},update:function(e){var r=this,i=r.getMeta(),o=r.chart.options;if(o.textPadding||o.minBarWidth||o.showText||o.colorFunction){var n=r.chart.options.elements;n.textPadding=o.textPadding||n.textPadding,n.minBarWidth=o.minBarWidth||n.minBarWidth,n.colorFunction=o.colorFunction||n.colorFunction,n.minBarWidth=o.minBarWidth||n.minBarWidth,!0!==t._tl_depwarn&&(console.log("Timeline Chart: Configuration deprecated. Please check document on Github."),t._tl_depwarn=!0)}a.each(i.data,function(t,a){r.updateElement(t,a,e)},r)},updateElement:function(t,e,r){var i=this,o=i.getMeta(),n=i.getDataset(),l=i._resolveDataElementOptions(t,e),d=i.getScaleForId(o.xAxisID),s=i.getScaleForId(o.yAxisID),h=n.data[e],c=d.getPixelForValue(h[l.keyStart]),u=s.getPixelForValue(h,i.index,i.index),f=d.getPixelForValue(h[l.keyEnd])-c,g=i.getRuler(e),m=i.calculateBarHeight(g);t._xScale=i.getScaleForId(o.xAxisID),t._yScale=i.getScaleForId(o.yAxisID),t._datasetIndex=i.index,t._index=e,t._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderSkipped:l.borderSkipped,borderWidth:l.borderWidth,datasetLabel:n.label,label:i.chart.data.labels[e],x:r?c-f:c,y:u-m/2,width:Math.max(f,l.minBarWidth),height:m,base:c+f,text:h[l.keyValue],textColor:a.color(l.backgroundColor).luminosity()>.5?"#000000":"#ffffff"};h[l.keyValue];var p=l.showText;t.draw=function(){var t=this._chart.ctx,e=this._view,a=t.globalAlpha,r=t.globalCompositeOperation;t.fillStyle=e.backgroundColor,t.lineWidth=e.borderWidth,t.globalCompositeOperation="destination-over",t.fillRect(e.x,e.y,e.width,e.height),t.globalAlpha=.5,t.globalCompositeOperation="source-over",t.fillRect(e.x,e.y,e.width,e.height);var i=e.borderWidth||0;if(i>0&&(t.save(),t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.clip(),t.fillStyle=e.borderColor,t.rect(e.x+i,e.y+i,e.width-2*i,e.height-2*i),t.fill("evenodd"),t.restore()),t.globalAlpha=a,t.globalCompositeOperation=r,p){t.beginPath();var o=t.measureText(e.text);o.width>0&&o.width+l.textPadding+2<e.width&&(l.font&&(t.font=l.font),t.fillStyle=e.textColor,t.lineWidth=0,t.strokeStyle=e.textColor,t.textBaseline="middle",t.fillText(e.text,e.x+l.textPadding,e.y+e.height/2)),t.fill()}},t.inXRange=function(t){var e=i.getBarBounds(this);return t>=e.left&&t<=e.right},t.tooltipPosition=function(){var t=this.getCenterPoint();return{x:t.x,y:t.y}},t.getCenterPoint=function(){var t=this._view;return{x:t.x+t.width/2,y:t.y+t.height/2}},t.inRange=function(t,e){var a=!1;if(this._view){var r=i.getBarBounds(this);a=t>=r.left&&t<=r.right&&e>=r.top&&e<=r.bottom}return a},t.pivot()},getBarCount:function(){var t=this,e=0;return a.each(t.chart.data.datasets,function(a,r){t.chart.getDatasetMeta(r).bar&&t.chart.isDatasetVisible(r)&&++e},t),e},draw:function(t){var e,a,r=t||1,i=this.getMeta().data;for(e=0,a=i.length;e<a;e++)i[e].transition(r).draw()},calculateBarHeight:function(t){var e=this.getScaleForId(this.getMeta().yAxisID);return e.options.barThickness?e.options.barThickness:e.options.stacked?t.categoryHeight:t.barHeight},_resolveDataElementOptions:function(t,e){var r=a.options.resolve,i=this,o=t&&t.custom,n=i._cachedDataOpts;if(n&&!o)return n;var l,d,s,h,c=i.chart,u=i._config,f=c.options.elements[i.dataElementType.prototype._type]||{},g=i._dataElementOptions,m={},p={chart:c,dataIndex:e,dataset:i.getDataset(),datasetIndex:i.index},y={cacheable:!o};if(o=o||{},a.isArray(g))for(d=0,s=g.length;d<s;++d)m[h=g[d]]=r([o[h],u[h],f[h]],p,e,y);else for(d=0,s=(l=Object.keys(g)).length;d<s;++d)m[h=l[d]]=r([o[h],u[g[h]],u[h],f[h]],p,e,y);f.keyStart||(f.keyStart=0),f.keyEnd||(f.keyEnd=1),f.keyValue||(f.keyValue=2),f.barThickness||(f.barThickness=30),f.maxBarThickness||(f.maxBarThickness=60),f.minBarWidth||(f.minBarWidth=40),f.showText||(f.showText=!0),f.textPadding||(f.textPadding=4),y.cacheable&&(i._cachedDataOpts=Object.freeze(m));i._getIndexScale().options,i._getValueScale().options;return m}}),t.defaults.timeline={elements:{colorFunction:function(){return a.color("black")},backgroundColor:"gold",borderColor:"orange",borderWidth:2,hoverBackgroundColor:"orange",hoverBorderColor:"red",hoverBorderWidth:1,showText:!0,textPadding:4,minBarWidth:1,keyStart:0,keyEnd:1,keyValue:2},layout:{padding:{left:0,right:0,top:0,bottom:0}},legend:{display:!1},scales:{xAxes:[{type:"timeline",position:"bottom",distribution:"linear",gridLines:{display:!0,drawBorder:!0,drawTicks:!0},ticks:{maxRotation:0},unit:"day"}],yAxes:[{type:"category",position:"left",barThickness:20,offset:!0,gridLines:{display:!0,offsetGridLines:!0,drawBorder:!0,drawTicks:!0}}]},tooltips:{callbacks:{title:function(t,e){this._chart.options.elements;return e.labels[t[0].datasetIndex]},label:function(t,a){var r=this._chart.options.elements,i=a.datasets[t.datasetIndex].data[t.index];return[i[r.keyValue],e(i[r.keyStart]).format("L LTS"),e(i[r.keyEnd]).format("L LTS")]}}}}});
